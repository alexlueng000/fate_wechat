<view class="page">
  <!-- 顶部用户卡片 -->
  <view class="card card-user">
    <!-- 头像：显示真实头像或默认头像 -->
    <view class="avatar-wrap">
      <image
        wx:if="{{avatarUrl}}"
        class="avatar-img"
        src="{{avatarUrl}}"
        mode="aspectFill"
      />
      <view wx:else class="avatar-text">{{initials}}</view>
    </view>

    <view class="user-info">
      <view class="user-name">{{isLoggedIn ? (username || '未登录') : '未登录'}}</view>

      <!-- 未登录时显示登录提示 -->
      <view wx:if="{{!isLoggedIn}}" class="auth-hint" bindtap="onAuthorize">
        <text class="auth-icon">✦</text>
        <text class="auth-text">登录解锁更多功能</text>
      </view>
    </view>
  </view>

  <!-- 我的记录 -->
  <view class="card">
    <view class="cell-title">我的记录</view>

    <view class="cell" bindtap="onHistory">
      <view class="cell-left">
        <text class="cell-label">历史分析</text>
        <text class="cell-desc">查看过往的分析记录</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>

    <view class="cell" bindtap="onClearLocal">
      <view class="cell-left">
        <text class="cell-label">清除数据</text>
        <text class="cell-desc">清空本地分析与对话记录</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>
  </view>

  <!-- 帮助与反馈 -->
  <view class="card">
    <view class="cell-title">帮助与反馈</view>

    <view class="cell" bindtap="onHelp">
      <view class="cell-left">
        <text class="cell-label">使用帮助</text>
        <text class="cell-desc">了解如何使用本小程序</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>

    <view class="cell" bindtap="onFeedback">
      <view class="cell-left">
        <text class="cell-label">意见反馈</text>
        <text class="cell-desc">告诉我们您的想法</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>

    <view class="cell" bindtap="onContact">
      <view class="cell-left">
        <text class="cell-label">联系客服</text>
        <text class="cell-desc">有问题请联系客服</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>
  </view>

  <!-- 关于 -->
  <view class="card">
    <view class="cell-title">关于</view>

    <view class="cell" bindtap="onAbout">
      <view class="cell-left">
        <text class="cell-label">关于我们</text>
        <text class="cell-desc">了解应用与开发者信息</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>

    <view class="cell" bindtap="onPrivacy">
      <view class="cell-left">
        <text class="cell-label">隐私政策</text>
        <text class="cell-desc">数据收集与使用说明</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>

    <view class="cell" bindtap="onAgreement">
      <view class="cell-left">
        <text class="cell-label">用户协议</text>
        <text class="cell-desc">使用本服务前请阅读</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>

    <view class="cell" bindtap="onDisclaimer">
      <view class="cell-left">
        <text class="cell-label">免责声明</text>
        <text class="cell-desc">分析内容仅供参考</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="card" wx:if="{{isLoggedIn}}">
    <view class="cell danger" bindtap="onLogout">
      <view class="cell-left">
        <text class="cell-label">退出登录</text>
        <text class="cell-desc">清除登录信息，下次将重新登录</text>
      </view>
      <text class="cell-arrow">›</text>
    </view>
  </view>

  <!-- 底部版本与评分 -->
  <view class="footer">
    <view class="version">版本：{{version}}</view>
    <view class="rate-btn" bindtap="onRate">
      <text>给我们评分</text>
      <text class="rate-icon">★</text>
    </view>
  </view>
</view>
