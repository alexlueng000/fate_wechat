<view class="page">

<!-- 聊天列表 -->
<scroll-view
  class="chat"
  scroll-y="true"
  scroll-with-animation="true"
  scroll-into-view="{{toView}}"
>
  <view class="chat-inner">
    <block wx:for="{{messages}}" wx:key="index" wx:for-item="msg" wx:for-index="index">
      <view id="msg-{{index}}" class="msg {{msg.role === 'user' ? 'right' : 'left'}}">
        <view class="bubble">
          <text class="bubble-text">
            {{msg.content}}
          </text>
        </view>
      </view>
    </block>
    <view id="end"></view>
  </view>
</scroll-view>

<!-- 快捷分析 -->
<view class="card quick-card">
  <view class="quick-title">快捷分析</view>
  <view class="quick-grid">
    <view class="quick-chip" bindtap="onQuickAsk" data-key="personality" data-label="性格特征">性格特征</view>
    <view class="quick-chip" bindtap="onQuickAsk" data-key="avatar" data-label="人物画像">人物画像</view>
    <view class="quick-chip" bindtap="onQuickAsk" data-key="love_timing" data-label="正缘应期">正缘应期</view>
    <view class="quick-chip" bindtap="onQuickAsk" data-key="career" data-label="事业建议">事业建议</view>
    <view class="quick-chip" bindtap="onQuickAsk" data-key="wealth" data-label="财运">财运</view>
    <view class="quick-chip" bindtap="onQuickAsk" data-key="health" data-label="健康">健康</view>
  </view>
</view>

<!-- 输入区 -->
<view class="inputBar">
  <input
    class="ipt"
    placeholder="来说点什么…"
    value="{{input}}"
    bindinput="onInput"
    confirm-type="send"
    bindconfirm="onSend"
  />
  <button class="sendBtn" bindtap="onSend" loading="{{loading}}" disabled="{{loading}}">
    发送
  </button>
</view>

<!-- 免责声明 -->
<view class="tip">* 对话仅供参考，不构成专业建议 *</view>

<view style="height: env(safe-area-inset-bottom)"></view>
</view>
