<view class="page">
  <view class="content">
    <!-- å½“å‰åˆ†æ -->
    <view class="section-title">å½“å‰åˆ†æ</view>
    <view wx:if="{{currentPaipan}}" class="card current" bindtap="onViewCurrent">
      <view class="card-header">
        <text class="card-name">{{currentPaipan.form.birth_date}} {{currentPaipan.form.birth_time}}</text>
        <text class="card-tag">å½“å‰</text>
      </view>
      <view class="card-info">
        <text class="info-item">{{currentPaipan.form.gender}}</text>
        <text class="info-item">{{currentPaipan.form.calendar === 'gregorian' ? 'å…¬å†' : 'å†œå†'}}</text>
        <text class="info-item">{{currentPaipan.form.birthplace}}</text>
      </view>
      <view class="card-footer">
        <text class="footer-text">ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</text>
        <text class="footer-arrow">â€º</text>
      </view>
    </view>
    <view wx:else class="empty">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— åˆ†æè®°å½•</text>
      <text class="empty-hint">è¯·å…ˆåœ¨åˆ†æé¡µé¢ç”Ÿæˆåˆ†æ</text>
    </view>

    <!-- å†å²è®°å½• -->
    <view class="section-title" wx:if="{{historyList.length > 0}}">å†å²è®°å½•</view>
    <view class="card-list">
      <view
        wx:for="{{historyList}}"
        wx:key="id"
        class="card"
        bindtap="onViewItem"
        data-item="{{item}}"
      >
        <view class="card-header">
          <text class="card-name">{{item.form.birth_date}} {{item.form.birth_time}}</text>
        </view>
        <view class="card-info">
          <text class="info-item">{{item.form.gender}}</text>
          <text class="info-item">{{item.form.calendar === 'gregorian' ? 'å…¬å†' : 'å†œå†'}}</text>
          <text class="info-item">{{item.form.birthplace}}</text>
        </view>
        <view class="card-footer">
          <text class="footer-time">{{item.createdAt}}</text>
          <text class="footer-arrow">â€º</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{!currentPaipan && historyList.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ“œ</text>
      <text class="empty-text">è¿˜æ²¡æœ‰å†å²è®°å½•</text>
      <button class="empty-btn" bindtap="onGoToIndex">å»åˆ†æ</button>
    </view>
  </view>
</view>
